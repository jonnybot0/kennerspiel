@main() {
    
    <div id="page" class="container"></div>
    
    <script type="text/template" id="tables-list-template">
        <h1>Tables</h1>
        <hr />
    
        <a href="#/new" class="btn btn-primary">New Table</a>
        <table class="table striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Game</th>
                    <th>Seed</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <% _.each(tables, function(table) { %>
                    <tr>
                        <td><a href="#/view/<%= table.get('id') %>"><%= table.get('name') %></a></td>
                        <td><%= table.get('game') %></td>
                        <td><%= table.get('seed') %></td>
                        <td><a href="#/edit/<%= table.get('id') %>" class="btn">Edit</a></td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </script>
    
    <script type="text/template" id="table-edit-template">
        <form class="table-edit-form">
            <legend><%= table ? 'Update' : 'Create' %> Table</legend>
            <label>Name</label>
            <input type="text" name="name" value="<%= table ? table.get('name') : '' %>" />
            <hr />
            <% if(table) { %>
                <input type="hidden" name="id" value="<%= table.get('id') %>" />
                <button type="button" class="btn btn-danger delete">Delete</button>
            <% }; %>
            <button type="submit" class="btn"><%= table ? 'Update' : 'Create' %></button>
        </form> 
    </script>

    <script type="text/template" id="table-view-template">
        <h1>Agricola: All Creatures Big &amp; Small</h1>
        <hr />
        <div class="row">
            <% var board = table.get('board'); %>
            
            <div class="span8">

                <div class="row">
                    
                    <% var space = board.actions.SP %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="SP">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="SP">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="SP">
                    <% } %>
                        &rarr; 1 Wood<br />
                        Starting Player<br />
                        <b><%= space.wood %> Wood</b>
                    </div>
                    
                    <% var space = board.actions.Wx3 %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="Wx3">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="Wx3">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="Wx3">
                    <% } %>
                        &rarr; 3 Wood<br />
                        <br />
                        <b><%= space.wood %> Wood</b>
                    </div>
                    
                    <% var space = board.actions.Sx1 %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="Sx1">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="Sx1">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="Sx1">
                    <% } %>
                        &rarr; 1 Stone<br />
                        <br />
                        <b><%= space.stone %> Stone</b>
                    </div>
                    
                    <% var space = board.actions.Sx2 %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="Sx2">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="Sx2">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="Sx2">
                    <% } %>
                        &rarr; 2 Stone<br />
                        <br />
                        <b><%= space.stone %> Stone</b>
                    </div>
                    
                </div>
                <div class="row">
                    <% var space = board.actions.WFen %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="WFen">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="WFen">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="WFen">
                    <% } %>
                        1 Wood &rarr; Build Fence
                    </div>
                    
                    <% var space = board.actions.SFen %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="SFen">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="SFen">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="SFen">
                    <% } %>
                        Build 2 Fences<br />
                        2 Stone &rarr; Build Fence<br />
                    </div>
                    
                    <% var space = board.actions.RSW %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="RSW">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="RSW">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="RSW">
                    <% } %>
                        +1 Wood<br />
                        +1 Stone<br />
                        +1 Reed
                    </div>
                    
                    <% var space = board.actions.Exp %>
                    <% if(space.occupant == "red") { %>
                    <div class="span2 action" data-command="Exp">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                    <% } else if(space.occupant == "blue") { %>
                    <div class="span2 action" data-command="Exp">
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                    <% } else { %>
                    <div class="span2 action usable" data-command="Exp">
                    <% } %>
                        &rarr; 1 Fence<br />
                        Expansion<br />
                        <b><%= space.fences %> Fences</b>
                    </div>
                </div>
                <!--
                <div class="row">
                    <div class="span2 action">3 Stone 1 Reed &rarr; Stall</div>
                    <div class="span2 action">
                        +1 Trough<br />
                        3 Wood &rarr; Trough
                    </div>
                    <div class="span2 action">&rarr; 1 Reed (1 Sheep)</div>
                    <div class="span2 action">&rarr; 1 Boar (1 sheep)</div>
                </div>
                <div class="row">
                    <div class="span2 action">
                        5 Wood/5 Stone<br />
                        Stall &rarr; Stables
                    </div>
                    <div class="span2">
                        <div class="row">
                            <div class="span2 half-action">Special Build</div>
                        </div>
                        <div class="row">
                            <div class="span2 half-action">Special Build</div>
                        </div>
                    </div>
                    <div class="span2 action">&rarr; 1 Cattle (1 Boar)</div>
                    <div class="span2 action">&rarr; 1 Horse (1 Sheep)</div>
                </div>
                -->

            </div>
            <div class="span4">
                Feeding Troughs: 10<br />
                Expansions:
                    <div>[Half-Timbered House]</div>
                    <div>[Storage Building]</div>
                    <div>[Shelter]</div>
                    <div>[Open Stables]</div>
                Stalls: 4<br />
            </div>
        </div>

        <div class="row">
            <div class="span6">
                <h3>Red Player</h3>
                <% var farm = board.redFarm %>
                <div class="red bin">
                    <% if(board.currentPlayer == 'red' && board.inputState == 'placeWorker') { %>
                        <% if(farm.workers >= 1) { %>
                        <div class="worker usable"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 2) { %>
                        <div class="worker usable"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 3) { %>
                        <div class="worker usable"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                        <% } %>
                    <% } else { %>
                        <% if(farm.workers >= 1) { %>
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 2) { %>
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 3) { %>
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-red.png")"/></div>
                        <% } %>
                    <% } %>
                    <ul>
                        <li>Wood:   <%= farm.wood %></li>
                        <li>Stone:  <%= farm.stone %></li>
                        <li>Reed:   <%= farm.reed %></li>
                        <li>Fences: <%= farm.fences %></li>
                    </ul>
                </div>
            </div>
            <div class="span6">
                <h3>Blue Player</h3>
                <% var farm = board.blueFarm %>
                <div class="blue bin">
                    <% if(board.currentPlayer == 'blue' && board.inputState == 'placeWorker') { %>
                        <% if(farm.workers >= 1) { %>
                        <div class="worker usable"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 2) { %>
                        <div class="worker usable"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 3) { %>
                        <div class="worker usable"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                        <% } %>
                    <% } else { %>
                        <% if(farm.workers >= 1) { %>
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 2) { %>
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                        <% } %>
                        <% if(farm.workers >= 3) { %>
                        <div class="worker"><img src="@routes.Assets.at("images/agricola2p/worker-blue.png")"/></div>
                        <% } %>
                    <% } %>
                    <ul>
                        <li>Wood:   <%= farm.wood %></li>
                        <li>Stone:  <%= farm.stone %></li>
                        <li>Reed:   <%= farm.reed %></li>
                        <li>Fences: <%= farm.fences %></li>
                    </ul>
                    
                    <table border="1" class="farm">
                        <tr>
                            <td data-y="0" data-x="8"></td>
                            <td data-y="0" data-x="9" class="hfence"></td>
                            <td data-y="0" data-x="10"></td>
                            <td data-y="0" data-x="11" class="hfence"></td>
                            <td data-y="0" data-x="12"></td>
                        </tr>
                        <tr>
                            <td data-y="1" data-x="8" class="vfence"></td>
                            <td data-y="1" data-x="9" class="farmtile"></td>
                            <td data-y="1" data-x="10" class="vfence"></td>
                            <td data-y="1" data-x="11" class="farmtile"></td>
                            <td data-y="1" data-x="12" class="vfence"></td>
                        </tr>
                        <tr>
                            <td data-y="2" data-x="8"></td>
                            <td data-y="2" data-x="9" class="hfence"></td>
                            <td data-y="2" data-x="10"></td>
                            <td data-y="2" data-x="11" class="hfence"></td>
                            <td data-y="2" data-x="12"></td>
                        </tr>
                        <tr>
                            <td data-y="3" data-x="8" class="vfence"></td>
                            <td data-y="3" data-x="9" class="farmtile"></td>
                            <td data-y="3" data-x="10" class="vfence"></td>
                            <td data-y="3" data-x="11" class="farmtile"></td>
                            <td data-y="3" data-x="12" class="vfence"></td>
                        </tr>
                        <tr>
                            <td data-y="4" data-x="8"></td>
                            <td data-y="4" data-x="9" class="hfence fenced"></td>
                            <td data-y="4" data-x="10"></td>
                            <td data-y="4" data-x="11" class="hfence"></td>
                            <td data-y="4" data-x="12"></td>
                        </tr>
                        <tr>
                            <td data-y="5" data-x="8" class="vfence fenced"></td>
                            <td data-y="5" data-x="9" class="farmtile">Cottage</td>
                            <td data-y="5" data-x="10" class="vfence fenced"></td>
                            <td data-y="5" data-x="11" class="farmtile"></td>
                            <td data-y="5" data-x="12" class="vfence"></td>
                        </tr>
                        <tr>
                            <td data-y="6" data-x="8"></td>
                            <td data-y="6" data-x="9" class="hfence fenced"></td>
                            <td data-y="6" data-x="10"></td>
                            <td data-y="6" data-x="11" class="hfence"></td>
                            <td data-y="6" data-x="12"></td>
                        </tr>
                    </table>
                    
                    
                </div>
            </div>
            
        </div>

        <hr />

        <div class="row">
            <div class="span6">

                <div id="alertPlaceholder"></div>
                <form class="undo-form" class="form-inline" data-command="undo">
                    <button type="submit" class="btn">Undo</button>
                </form>
                <form class="commit-form" class="form-inline" data-command="commit">
                    <% if(board.inputState == 'waitingOnCommit') { %>
                    <button type="submit" class="btn">Commit</button>
                    <% } %>
                </form>
            </div>

            <div class="span6">
                Move List:
                <ul>
                    <% _.each(table.get('commands').models, function(command) { %>
                        <li><%= command.get('command') %></li>
                    <% }); %>
                </li>
            </div>
        </div>
        <script src='@routes.Assets.at("javascripts/interface.js")'></script>


    </script>
    
    <script src='@routes.Assets.at("javascripts/index.js")'></script>
    
}
